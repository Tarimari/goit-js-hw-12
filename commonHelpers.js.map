{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from 'axios';\n\n\nlet currentPage = 1;\nlet characteristics;\nconst perPage = 40;\nconst form = document.querySelector(`.submit-form`);\nconst list = document.querySelector(`.gallery`);\nconst btnMore = document.querySelector(`.js-more`);\nconst loading = document.querySelector(`.js-loading`)\nform.addEventListener(`submit`, searchRequest);\nbtnMore.addEventListener(`click`, onLoad);\n\nfunction onLoad() { \n  currentPage += 1;\n  getRequest(characteristics)\n    .then(data => {\n            list.insertAdjacentHTML(`beforeend`,createMarkup(data.hits))\n            initializeLightbox();\n            const card = document.querySelector(`.gallery__item`).getBoundingClientRect().height;\n      window.scrollBy(\n        {\n                top: card * 2,\n                behavior: `smooth`\n        });\n                  })\n        .catch(err => console.log(err))\n   \n}\nfunction searchRequest(evt) {\n    evt.preventDefault();\n  loading.innerHTML = `<span class=\"loader\"></span>`;\n  if (evt.currentTarget.elements.search.value !== characteristics) {\n    list.innerHTML = ``;\n    currentPage = 1;\n  }\n  characteristics = evt.currentTarget.elements.search.value;\n  \n  getRequest(characteristics)  \n    .then(data => {\n      if (data.hits.length === 0)\n                 { iziToast.show({\n                    message: '❌ Sorry, there are no images matching your search query. Please try again!'\n                 });\n        loading.innerHTML = ``;\n        btnMore.classList.add(`search-btn-hidden`);\n        return;\n      }\n      loading.innerHTML = ``;\n      list.insertAdjacentHTML(`beforeend`,createMarkup(data.hits))\n      initializeLightbox();\n      if (currentPage === 1) {\n        btnMore.classList.remove(`search-btn-hidden`);\n      }\n      if (currentPage > data.totalHits / perPage) {\n        btnMore.classList.add(`search-btn-hidden`);\n        iziToast.show(\n        {\n          message: \"We're sorry, but you've reached the end of search results.\"\n        }\n        );\n      }\n        })\n        .catch(err => console.log(err))\n    \n}\n\nfunction createMarkup(arr) {\n        return arr.map( ({webformatURL, largeImageURL, tags, likes, views, comments, downloads} ) => `\n        <li class=\"gallery__item\">\n          <a class=\"gallery__link\" href=\"${largeImageURL}\">\n            <img class=\"gallery__image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n          </a>\n          <ul class=\"gallery-stats\">\n            <li class=\"gallery-stats-item\">\n              <h3 class=\"stats-head\">Likes</h3>\n              <p class=\"stats-indicator\">${likes}</p>\n            </li>\n            <li class=\"gallery-stats-item\">\n              <h3 class=\"stats-head\">Views</h3>\n              <p class=\"stats-indicator\">${views}</p>\n            </li>\n            <li class=\"gallery-stats-item\">\n              <h3 class=\"stats-head\">Comments</h3>\n              <p class=\"stats-indicator\">${comments}</p>\n            </li>\n            <li class=\"gallery-stats-item\">\n              <h3 class=\"stats-head\">Downloads</h3>\n              <p class=\"stats-indicator\">${downloads}</p>\n            </li>\n          </ul>\n        </li>\n   `).join(``)\n}\n\nasync function getRequest(characteristics) {\n\n    const BASE_URL = `https://pixabay.com/api/`;\n    const API_KEY = `41768952-3eb5a1819d194e4ebd739434d`\n  const response = await axios.get(`${BASE_URL}?key=${API_KEY}&q=${characteristics}\n  &image_type=photo&orientation=horizontal&safesearch=true&per_page=${perPage}&page=${currentPage}`)\n    return response.data\n\n}\n\nfunction initializeLightbox() {\n    const instance = new SimpleLightbox('.gallery a', {\n        captionsDelay: 250,\n        captionPosition: \"bottom\",\n    });\n    instance.refresh();\n}\n\n"],"names":["currentPage","characteristics","perPage","form","list","btnMore","loading","searchRequest","onLoad","getRequest","data","createMarkup","initializeLightbox","card","err","evt","iziToast","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","BASE_URL","API_KEY","axios","SimpleLightbox"],"mappings":"owBAQA,IAAIA,EAAc,EACdC,EACJ,MAAMC,EAAU,GACVC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAO,SAAS,cAAc,UAAU,EACxCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,aAAa,EACpDH,EAAK,iBAAiB,SAAUI,CAAa,EAC7CF,EAAQ,iBAAiB,QAASG,CAAM,EAExC,SAASA,GAAS,CAChBR,GAAe,EACfS,EAAWR,CAAe,EACvB,KAAKS,GAAQ,CACNN,EAAK,mBAAmB,YAAYO,EAAaD,EAAK,IAAI,CAAC,EAC3DE,IACA,MAAMC,EAAO,SAAS,cAAc,gBAAgB,EAAE,sBAAuB,EAAC,OACpF,OAAO,SACL,CACQ,IAAKA,EAAO,EACZ,SAAU,QAC1B,CAAS,CACT,CAAmB,EACV,MAAMC,GAAO,QAAQ,IAAIA,CAAG,CAAC,CAEtC,CACA,SAASP,EAAcQ,EAAK,CACxBA,EAAI,eAAc,EACpBT,EAAQ,UAAY,+BAChBS,EAAI,cAAc,SAAS,OAAO,QAAUd,IAC9CG,EAAK,UAAY,GACjBJ,EAAc,GAEhBC,EAAkBc,EAAI,cAAc,SAAS,OAAO,MAEpDN,EAAWR,CAAe,EACvB,KAAKS,GAAQ,CACZ,GAAIA,EAAK,KAAK,SAAW,EACd,CAAEM,EAAS,KAAK,CACb,QAAS,4EAC7B,CAAkB,EACVV,EAAQ,UAAY,GACpBD,EAAQ,UAAU,IAAI,mBAAmB,EACzC,MACD,CACDC,EAAQ,UAAY,GACpBF,EAAK,mBAAmB,YAAYO,EAAaD,EAAK,IAAI,CAAC,EAC3DE,IACIZ,IAAgB,GAClBK,EAAQ,UAAU,OAAO,mBAAmB,EAE1CL,EAAcU,EAAK,UAAYR,IACjCG,EAAQ,UAAU,IAAI,mBAAmB,EACzCW,EAAS,KACT,CACE,QAAS,4DACV,CACT,EAEA,CAAS,EACA,MAAMF,GAAO,QAAQ,IAAIA,CAAG,CAAC,CAEtC,CAEA,SAASH,EAAaM,EAAK,CACnB,OAAOA,EAAI,IAAK,CAAC,CAAC,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA;AAAA,2CAE1DL;AAAA,+CACID,WAAsBE;AAAA;AAAA;AAAA;AAAA;AAAA,2CAK1BC;AAAA;AAAA;AAAA;AAAA,2CAIAC;AAAA;AAAA;AAAA;AAAA,2CAIAC;AAAA;AAAA;AAAA;AAAA,2CAIAC;AAAA;AAAA;AAAA;AAAA,IAIvC,EAAE,KAAK,EAAE,CACb,CAEA,eAAef,EAAWR,EAAiB,CAEvC,MAAMwB,EAAW,2BACXC,EAAU,qCAGhB,OAFe,MAAMC,EAAM,IAAI,GAAGF,SAAgBC,OAAazB;AAAA,sEACGC,UAAgBF,GAAa,GAC/E,IAEpB,CAEA,SAASY,GAAqB,CACT,IAAIgB,EAAe,aAAc,CAC9C,cAAe,IACf,gBAAiB,QACzB,CAAK,EACQ,QAAO,CACpB"}