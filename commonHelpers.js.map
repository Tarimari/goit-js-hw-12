{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from 'axios';\n\n\n// const axios = require(`axios`).default;\nlet currentPage = 1;\nlet characteristics;\nconst perPage = 40;\nconst form = document.querySelector(`.submit-form`);\nconst list = document.querySelector(`.gallery`);\nconst btnMore = document.querySelector(`.js-more`);\nconst loading = document.querySelector(`.js-loading`)\nform.addEventListener(`submit`, searchRequest);\nbtnMore.addEventListener(`click`, onLoad);\n\nfunction onLoad() {\n  currentPage += 1;\n  getRequest(characteristics)\n    .then(data => {\n            list.insertAdjacentHTML(`beforeend`,createMarkup(data.hits))\n            initializeLightbox();\n        })\n        .catch(err => console.log(err))\n    \n}\nfunction searchRequest(evt) {\n    evt.preventDefault();\n  loading.innerHTML = `<span class=\"loader\"></span>`;\n  if (evt.currentTarget.elements.search.value !== characteristics) {\n    list.innerHTML = ``;\n  }\n  characteristics = evt.currentTarget.elements.search.value;\n  \n  getRequest(characteristics)  \n    .then(data => {\n      if (data.hits.length === 0)\n                 { iziToast.show({\n                    message: '❌ Sorry, there are no images matching your search query. Please try again!'\n                 });\n                list.innerHTML = ``;\n        return;\n      }\n            list.insertAdjacentHTML(`beforeend`,createMarkup(data.hits))\n      initializeLightbox();\n      console.log(data)\n      if (currentPage === 1) {\n        btnMore.hidden = false;\n      }\n      console.log(currentPage)\n      console.log(data.totalHits)\n      console.log(perPage)\n      if (currentPage > data.totalHits / perPage) {\n        btnMore.hidden = true;\n        iziToast.show({\n                    message: \"We're sorry, but you've reached the end of search results.\"\n                 });\n      }\n        })\n        .catch(err => console.log(err))\n    \n}\n\nfunction createMarkup(arr) {\n        return arr.map( ({webformatURL, largeImageURL, tags, likes, views, comments, downloads} ) => `\n        <li class=\"gallery__item\">\n          <a class=\"gallery__link\" href=\"${largeImageURL}\">\n            <img class=\"gallery__image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n          </a>\n          <ul class=\"gallery-stats\">\n            <li class=\"gallery-stats-item\">\n              <h3 class=\"stats-head\">Likes</h3>\n              <p class=\"stats-indicator\">${likes}</p>\n            </li>\n            <li class=\"gallery-stats-item\">\n              <h3 class=\"stats-head\">Views</h3>\n              <p class=\"stats-indicator\">${views}</p>\n            </li>\n            <li class=\"gallery-stats-item\">\n              <h3 class=\"stats-head\">Comments</h3>\n              <p class=\"stats-indicator\">${comments}</p>\n            </li>\n            <li class=\"gallery-stats-item\">\n              <h3 class=\"stats-head\">Downloads</h3>\n              <p class=\"stats-indicator\">${downloads}</p>\n            </li>\n          </ul>\n        </li>\n   `).join(``)\n}\n\nasync function getRequest(characteristics) {\n\n    const BASE_URL = `https://pixabay.com/api/`;\n    const API_KEY = `41768952-3eb5a1819d194e4ebd739434d`\n  const response = await axios.get(`${BASE_URL}?key=${API_KEY}&q=${characteristics}\n  &image_type=photo&orientation=horizontal&safesearch=true&per_page=${perPage}&page=${currentPage}`)\n    return response.data\n\n}\n\nfunction initializeLightbox() {\n    const instance = new SimpleLightbox('.gallery a', {\n        captionsDelay: 250,\n        captionPosition: \"bottom\",\n    });\n    instance.refresh();\n}\n"],"names":["currentPage","characteristics","perPage","form","list","btnMore","loading","searchRequest","onLoad","getRequest","data","createMarkup","initializeLightbox","err","evt","iziToast","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","BASE_URL","API_KEY","axios","SimpleLightbox"],"mappings":"owBASA,IAAIA,EAAc,EACdC,EACJ,MAAMC,EAAU,GACVC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAO,SAAS,cAAc,UAAU,EACxCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,aAAa,EACpDH,EAAK,iBAAiB,SAAUI,CAAa,EAC7CF,EAAQ,iBAAiB,QAASG,CAAM,EAExC,SAASA,GAAS,CAChBR,GAAe,EACfS,EAAWR,CAAe,EACvB,KAAKS,GAAQ,CACNN,EAAK,mBAAmB,YAAYO,EAAaD,EAAK,IAAI,CAAC,EAC3DE,GACZ,CAAS,EACA,MAAMC,GAAO,QAAQ,IAAIA,CAAG,CAAC,CAEtC,CACA,SAASN,EAAcO,EAAK,CACxBA,EAAI,eAAc,EACpBR,EAAQ,UAAY,+BAChBQ,EAAI,cAAc,SAAS,OAAO,QAAUb,IAC9CG,EAAK,UAAY,IAEnBH,EAAkBa,EAAI,cAAc,SAAS,OAAO,MAEpDL,EAAWR,CAAe,EACvB,KAAKS,GAAQ,CACZ,GAAIA,EAAK,KAAK,SAAW,EACd,CAAEK,EAAS,KAAK,CACb,QAAS,4EAC7B,CAAkB,EACFX,EAAK,UAAY,GACzB,MACD,CACKA,EAAK,mBAAmB,YAAYO,EAAaD,EAAK,IAAI,CAAC,EACjEE,IACA,QAAQ,IAAIF,CAAI,EACZV,IAAgB,IAClBK,EAAQ,OAAS,IAEnB,QAAQ,IAAIL,CAAW,EACvB,QAAQ,IAAIU,EAAK,SAAS,EAC1B,QAAQ,IAAIR,CAAO,EACfF,EAAcU,EAAK,UAAYR,IACjCG,EAAQ,OAAS,GACjBU,EAAS,KAAK,CACF,QAAS,4DAC7B,CAAkB,EAElB,CAAS,EACA,MAAMF,GAAO,QAAQ,IAAIA,CAAG,CAAC,CAEtC,CAEA,SAASF,EAAaK,EAAK,CACnB,OAAOA,EAAI,IAAK,CAAC,CAAC,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA;AAAA,2CAE1DL;AAAA,+CACID,WAAsBE;AAAA;AAAA;AAAA;AAAA;AAAA,2CAK1BC;AAAA;AAAA;AAAA;AAAA,2CAIAC;AAAA;AAAA;AAAA;AAAA,2CAIAC;AAAA;AAAA;AAAA;AAAA,2CAIAC;AAAA;AAAA;AAAA;AAAA,IAIvC,EAAE,KAAK,EAAE,CACb,CAEA,eAAed,EAAWR,EAAiB,CAEvC,MAAMuB,EAAW,2BACXC,EAAU,qCAGhB,OAFe,MAAMC,EAAM,IAAI,GAAGF,SAAgBC,OAAaxB;AAAA,sEACGC,UAAgBF,GAAa,GAC/E,IAEpB,CAEA,SAASY,GAAqB,CACT,IAAIe,EAAe,aAAc,CAC9C,cAAe,IACf,gBAAiB,QACzB,CAAK,EACQ,QAAO,CACpB"}